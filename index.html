<!DOCTYPE html>
<html>
<head>
  <title>Interactive 3D Graph</title>
  <style>
    body {
      margin: 0;
      overflow: hidden; /* Prevent scroll bars */
    }
    #3d-graph {
      width: 100vw;
      height: 100vh;
      background-color: #000;
    }
  </style>

  <!-- Main library for the 3D force graph -->
  <script src="//cdn.jsdelivr.net/npm/3d-force-graph"></script>
</head>

<body>
  <div id="3d-graph"></div>

  <script type="module">
    // Import a library for creating 3D text labels
    import SpriteText from "https://esm.sh/three-spritetext";

    // Fetch the graph data from your nodePositions.json file
    fetch('nodePositions.json')
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(data => {
        const Graph = new ForceGraph3D(document.getElementById('3d-graph'))
          // Pass the fetched data to the graph
          .graphData(data)
          // Automatically color nodes based on their 'group' property
          .nodeAutoColorBy('group')
          // Custom function to create a text sprite for each node's label
          .nodeThreeObject(node => {
            const sprite = new SpriteText(node.name || node.id); // Use name or id as label
            sprite.material.depthWrite = false; // Make sprite always visible
            sprite.color = node.color;
            sprite.textHeight = 8;
            return sprite;
          })
          // Disable automatic positioning adjustments for the custom object
          .nodeThreeObjectExtend(true)
          .linkWidth(1); // Set the width of the links

        // Adjust the force strength to spread nodes out a little more
        Graph.d3Force('charge').strength(-250);
      })
      .catch(error => {
        console.error("Failed to load graph data:", error);
      });
  </script>
</body>
</html>
